{% extends 'game/base.html' %}
{% load static %}
{% load number_filters %}

{% block title %}ê²°ê³¼ - ìœ ë‹ˆì½˜ ë©”ì´ì»¤{% endblock %}

{% block content %}
<div class="result-page {% if investment.is_success %}success{% else %}failure{% endif %}">
    
    <!-- ê²°ê³¼ í—¤ë” -->
    <div class="result-header">
        <div class="result-character-image">
            {% if investment.is_success %}
                <img src="{% static 'images/characters/' %}{{ character_key }}_success.png" alt="{{ investment.character_name }}">
            {% else %}
                <img src="{% static 'images/characters/' %}{{ character_key }}_fail.png" alt="{{ investment.character_name }}">
            {% endif %}
        </div>
        {% if investment.is_success %}
            <h1>ğŸ‰ íˆ¬ì ì„±ê³µ!</h1>
            <p class="profit-rate">+{{ investment.profit_rate }}% ìˆ˜ìµ</p>
        {% else %}
            <h1>ğŸ’€ íˆ¬ì ì‹¤íŒ¨...</h1>
            <p class="profit-rate">-100% ì†ì‹¤</p>
        {% endif %}
    </div>

    <!-- íˆ¬ì ì •ë³´ -->
    <div class="investment-info">
        <p><strong>ìºë¦­í„°:</strong> {{ investment.character_name }}</p>
        <p><strong>ì•„ì´ë””ì–´:</strong> {{ investment.idea_title }}</p>
        <p><strong>íˆ¬ìê¸ˆ:</strong> {{ investment.invest_amount|add_comma }}ë§Œì›</p>
    </div>

    <!-- AI ê²°ê³¼ ë©”ì‹œì§€ -->
    <div class="result-message">
        <div class="system-msg">
            <span class="tag">[SYSTEM]</span>
            <p>{{ investment.result_system_msg }}</p>
        </div>
        <div class="character-reaction">
            <span class="tag">[{{ investment.character_name }}]</span>
            <p>{{ investment.result_character_reaction }}</p>
        </div>
    </div>

    <!-- í˜„ì¬ ê²Œì„ ìƒíƒœ -->
    <div class="game-status">
        <div class="status-item">
            <span class="label">ğŸ’° í˜„ì¬ ìë³¸ê¸ˆ</span>
            <span class="value">{{ session.current_capital|korean_currency }}</span>
        </div>
        <div class="status-item">
            <span class="label">ğŸ¯ ë‚¨ì€ ê¸°íšŒ</span>
            <span class="value">{{ session.remaining_chances }}íšŒ</span>
        </div>
    </div>

    <!-- ë‹¤ìŒ ë²„íŠ¼ -->
    <div class="btn-group">
        {% if session.is_finished %}
            <a href="{% url 'game:ranking' %}" class="btn btn-primary">ğŸ† ë­í‚¹ í™•ì¸</a>
            <a href="{% url 'game:game_start' %}" class="btn btn-secondary">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</a>
        {% else %}
            <a href="{% url 'game:play' session_id=session.pk %}" class="btn btn-primary">ë‹¤ìŒ íˆ¬ì â†’</a>
        {% endif %}
    </div>
</div>
{% endblock %}
