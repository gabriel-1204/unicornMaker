{% extends 'game/base.html' %}
{% load static %}
{% load number_filters %}

{% block title %}íˆ¬ìí•˜ê¸° - ìœ ë‹ˆì½˜ ë©”ì´ì»¤{% endblock %}

{% block content %}
<div class="play-page">
    <!-- ê²Œì„ ìƒíƒœ í‘œì‹œ -->
    <div class="game-status">
        <div class="status-item">
            <span class="label">ğŸ’° ìë³¸ê¸ˆ</span>
            <span class="value">{{ session.current_capital|korean_currency }}</span>
        </div>
        <div class="status-item">
            <span class="label">ğŸ¯ ë‚¨ì€ ê¸°íšŒ</span>
            <span class="value">{{ session.remaining_chances }}íšŒ</span>
        </div>
    </div>

    <!-- ìºë¦­í„° & ì•„ì´ë””ì–´ -->
    <div class="character-box">
        <div class="character-info">
            <div class="character-image">
                <img src="{% static 'images/characters/' %}{{ character.key }}.png" alt="{{ character.name }}">
            </div>
            <h2>{{ character.name }}</h2>
            <p class="character-concept">{{ character.concept }}</p>
        </div>
        
        <div class="idea-bubble">
            <h3>ğŸ’¡ {{ idea.title }}</h3>
            <p>{{ idea.description }}</p>
        </div>
    </div>

    <!-- íˆ¬ì í¼ -->
    <div class="invest-section">
        <form method="POST" action="{% url 'game:invest' session_id=session.pk %}">
            {% csrf_token %}
            
            <div class="form-group">
                <label>íˆ¬ì ê¸ˆì•¡ (ë§Œì›)</label>
                <input type="number" name="amount" 
                       min="2000" 
                       max="{{ session.current_capital }}" 
                       value="2000"
                       required>
                <small>ìµœì†Œ 2,000ë§Œì› ì´ìƒ íˆ¬ì ê°€ëŠ¥</small>
            </div>
            
            <div class="btn-group">
                <button type="submit" class="btn btn-primary">ğŸ’¸ íˆ¬ìí•˜ê¸°</button>
                <button type="button" class="btn btn-danger" onclick="setAllIn()">ğŸ”¥ ì˜¬ì¸</button>
                <a href="{% url 'game:pass' session_id=session.pk %}" class="btn btn-secondary">â­ï¸ íŒ¨ìŠ¤</a>
            </div>
        </form>
        
        <script>
        function setAllIn() {
            const maxCapital = {{ session.current_capital }};
            document.querySelector('input[name="amount"]').value = maxCapital;
        }
        </script>
    </div>
</div>
{% endblock %}
